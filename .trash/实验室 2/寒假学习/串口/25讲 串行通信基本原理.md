# 1. 通讯背景知识介绍
## 串口通信协议简介
- 物理层：
	- 规定通讯协议中具有机械、电子功能部分的特性，确保原始数据在物理媒体的传输。其实就是硬件部分
- 协议层：
	- 协议层主要规定通讯逻辑，统一收发双方的数据打包、解包标准。其实就是软件部分
## 处理器与外部通信的两种方式
- 并行通信
	- 传输原理：数据各个位同时传输
	- 优点：速度快
	- 缺点：占用引脚资源多
	- 按照数据传输的方向分为：
		- ==单工==：数据传输只在一个方向上传输
		- ==半双工==：允许数据在两个方向上传输，但是，在某一时刻，只允许数据在一个方向上传输，它实际是一种切换方向的单工通信
		- ==全双工==：允许数据同时在两个方向上传输，因此，全双工通信是两个单工通信的结合，他要求发送设备和接收设备都有独立的接收和发送能力
![[Pasted image 20220117153234.png]]
- 串行通信
	- 传输原理：数据按位顺序传输
	- 优点：占用引脚资源少
	- 缺点：速度相对较慢
	- 通信方式：
		- 同步通信：带时钟同步信号传输
			- SPI，IIC通信接口
		- 异步通信：不带时钟同步信号传输
			- UART（通用异步收发器），单总线
## 常见串行通信接口
![[Pasted image 20220119110107.png]]
## STM32的串口通信
- UART：通用异步收发器
- USART：通用同步异步收发器（可以作为UART使用）
大容量STM32F10x系列芯片，包含三个USART和两个UART
## UART异步通信方式引脚
 - RXD：数据输入引脚
 - TXD：数据输出引脚
![[Pasted image 20220120160843.png]]
## UART异步通信方式特点
- 双全异步通信
- 分数波特率发生器系统，提供精准的波特率
	- 发送和接收共用的可编程波特率，最高可达4.5Mbits/s
- 可编程的数据字长度（8位或者9位）
- 可配置的停止位（支持1或者2位停止位）
- 可配置的使用DMA多缓冲器通信
- 单独的发送器和接收器使能位
- 检测标志：
	- 接受缓冲器
	- 发送缓冲器空
	- 传输结束标志
- 多个带标志的中断源
- 其他：
	- 校验控制
	- 四个错误检测标志
## 串口通信过程
![[Pasted image 20220123181335.png]]
## STM32串口异步通信需要定义的参数
1. 起始位
2. 数据位（8位或者9位）
3. 奇偶校验位（第9位）
4. 停止位（第1，15，2位）
5. 波特率设置

对于F10x系列大容量芯片：
串口一——$f_{PCLK1}$
串口二到四——$f_{PCLK2}$
